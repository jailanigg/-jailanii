Halo! Saya adalah **Coding Partner** kamu. Saya siap membantu kamu membuat kode program ini.

Ini adalah proyek yang menarik! Kamu ingin membuat sistem **Video Streaming (CCTV sederhana)** dari HP ke Laptop melalui internet yang berbeda (antar jaringan).

### ⚠️ Klarifikasi Penting tentang "1G"

Saya perlu meluruskan sedikit hal teknis: **Internet 1G** (Generasi ke-1) adalah teknologi analog tahun 1980-an yang sudah tidak ada dan **tidak bisa** mengirim data digital apalagi video.

Saya berasumsi maksud kamu adalah menggunakan **Data Seluler biasa (3G/4G)** atau koneksi yang mungkin **sangat lambat**. Oleh karena itu, saya akan membuatkan kode yang mengompres gambar agar tetap ringan.

---

### 1. Gambaran Solusi

Karena HP dan Laptop menggunakan internet yang berbeda (Laptop pakai Wi-Fi rumah, HP pakai Data Seluler), kita tidak bisa menyambungkannya secara langsung. Kita butuh bantuan alat bernama **Ngrok**.

**Cara kerjanya:**

1. **Laptop (Server):** Menjalankan program Python untuk menerima gambar dan menampilkannya.
2. **Ngrok:** Membuat "terowongan" (tunnel) agar Laptop kamu bisa diakses dari internet publik.
3. **HP (Client):** Membuka browser (Chrome/Safari), mengakses link dari Ngrok, dan mengirimkan gambar dari kamera secara terus menerus.

### 2. Persiapan

Di Laptop kamu, pastikan sudah terinstall:

1. **Python** (Download di python.org).
2. **Library Python:** Buka terminal/CMD dan ketik:
```bash
pip install flask opencv-python numpy

```


3. **Ngrok:** Download di [ngrok.com](https://ngrok.com), daftar akun gratis, dan install.

---

### 3. Kode Program

Kita butuh 2 file dalam satu folder. Buat folder baru bernama `kamera_hp`.

#### File 1: `server.py` (Simpan di folder `kamera_hp`)

Ini adalah otak program yang berjalan di Laptop.

```python
import cv2
import numpy as np
import base64
from flask import Flask, render_template, request

# Inisialisasi Flask
app = Flask(__name__)

# Halaman utama yang akan dibuka oleh HP
@app.route('/')
def index():
    return render_template('index.html')

# Jalur untuk menerima gambar dari HP
@app.route('/upload_frame', methods=['POST'])
def upload_frame():
    try:
        # 1. Terima data gambar (dalam format base64 string)
        data_url = request.form['image']
        header, encoded = data_url.split(",", 1)
        
        # 2. Decode data menjadi gambar yang bisa dibaca komputer
        data = base64.b64decode(encoded)
        np_arr = np.frombuffer(data, np.uint8)
        frame = cv2.imdecode(np_arr, cv2.IMREAD_COLOR)

        # 3. Tampilkan gambar di layar Laptop
        if frame is not None:
            cv2.imshow("Video dari HP (Tekan 'q' untuk keluar)", frame)
            
            # Wajib ada agar window tidak hang (tunggu 1ms)
            cv2.waitKey(1)

        return "Sukses", 200
    except Exception as e:
        print(f"Error: {e}")
        return "Gagal", 500

if __name__ == '__main__':
    print("=== Server Berjalan ===")
    print("Menunggu koneksi dari HP...")
    # Menjalankan server di port 5000
    app.run(host='0.0.0.0', port=5000, debug=True)

```

#### File 2: `index.html`

**PENTING:** Kamu harus membuat folder bernama `templates` di dalam folder `kamera_hp`, lalu simpan file ini di dalamnya (`kamera_hp/templates/index.html`).

Ini adalah tampilan yang akan muncul di HP untuk mengakses kamera.

```html
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kamera Pengirim</title>
    <style>
        body { background-color: #222; color: white; text-align: center; font-family: sans-serif; }
        video { width: 80%; border: 2px solid red; margin-top: 20px; }
        #status { margin-top: 10px; color: yellow; }
    </style>
</head>
<body>
    <h2>Kamera Aktif</h2>
    <p>Sedang mengirim ke Laptop...</p>
    <video id="videoElement" autoplay playsinline></video>
    <canvas id="canvas" style="display:none;"></canvas>
    <div id="status">Menunggu kamera...</div>

    <script>
        const video = document.getElementById('videoElement');
        const canvas = document.getElementById('canvas');
        const context = canvas.getContext('2d');
        const status = document.getElementById('status');

        // 1. Minta izin akses kamera
        if (navigator.mediaDevices.getUserMedia) {
            navigator.mediaDevices.getUserMedia({ video: { width: 320, height: 240 } }) // Resolusi rendah agar cepat
                .then(function (stream) {
                    video.srcObject = stream;
                    status.innerText = "Kamera Terhubung! Mengirim data...";
                    // Mulai kirim gambar setiap 200ms (5 FPS) agar hemat kuota
                    setInterval(sendFrame, 200);
                })
                .catch(function (err) {
                    status.innerText = "Gagal akses kamera: " + err;
                });
        }

        // 2. Fungsi mengirim gambar ke server
        function sendFrame() {
            // Gambar frame video ke canvas
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);

            // Ubah jadi data JPG (kualitas 0.5/50% untuk hemat data)
            const dataURL = canvas.toDataURL('image/jpeg', 0.5);

            // Kirim ke Laptop via POST request
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/upload_frame", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.send("image=" + encodeURIComponent(dataURL));
        }
    </script>
</body>
</html>

```

---

### 4. Cara Menjalankan (Langkah demi Langkah)

Ikuti urutan ini dengan teliti:

**Langkah 1: Jalankan Server Python di Laptop**

1. Buka Terminal/CMD.
2. Masuk ke folder `kamera_hp`.
3. Jalankan perintah: `python server.py`
4. Jangan tutup terminal ini.

**Langkah 2: Jalankan Ngrok di Laptop (Agar bisa online)**

1. Buka Terminal/CMD baru (terminal Python biarkan tetap jalan).
2. Jalankan perintah: `ngrok http 5000`
3. Ngrok akan memberikan link forwarding, contohnya: `https://a1b2-c3d4.ngrok-free.app`
4. **Copy link yang berawalan https tersebut.**

**Langkah 3: Buka di HP**

1. Pastikan HP menggunakan data seluler (internet beda).
2. Buka Browser (Chrome/Safari) di HP.
3. Paste/buka link dari Ngrok tadi.
4. Browser akan meminta izin kamera -> Klik **Allow/Izinkan**.

**Hasil:**
Gambar dari HP akan muncul di layar Laptop kamu!

### Catatan Koding:

* **Mengapa `width: 320`?** Saya menyetel resolusi kamera menjadi 320x240 di kode HTML. Ini agar data yang dikirim kecil, sehingga di koneksi lambat pun videonya tidak terlalu *lag*.
* **Mengapa `setInterval(..., 200)`?** Artinya HP mengirim gambar setiap 200 milidetik (sekitar 5 gambar per detik). Jika internetmu sangat lambat, ubah angka `200` menjadi `500` atau `1000`.

Apakah kamu ingin saya jelaskan bagian tertentu dari kode tersebut?
